import { logger } from "./logger.js";
export async function waitForElementToVisible(page, selector, retries = 3, timeout = 10000, delayBetweenRetries = 1000, label = 'element') {
    for (let attempt = 1; attempt <= retries; attempt++) {
        try {
            logger.info(`[${label}] Attempt ${attempt}/${retries}: waiting for visible (timeout ${timeout}ms)`);
            await page.locator(selector).waitFor({ state: 'visible', timeout });
            console.log(`[${label}] Element became visible.`);
            return;
        }
        catch (error) {
            logger.warn(`[${label}] Retry ${attempt} failed.`);
            if (attempt === retries) {
                const errorMessage = `[${label}] Element not visible after ${retries} retries. Last error: ${error.message}`;
                logger.error(errorMessage);
                throw new Error(errorMessage);
            }
            await new Promise((res) => setTimeout(res, delayBetweenRetries));
        }
    }
}
